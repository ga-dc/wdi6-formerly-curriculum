<!DOCTYPE HTML>
<html lang="en" >
    
    <head>
        
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <title>Sessions and Auth | Welcome to GA&#39;s WDI-DC</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.2.0">
        
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">
        
    <link rel="stylesheet" href="../../gitbook/style.css">
    
    

        
    
    
    <link rel="next" href="../../05-mvc-with-rails/rails-deployment/readme.html" />
    
    
    <link rel="prev" href="../../05-mvc-with-rails/rails-helpers/readme.html" />
    

        
    </head>
    <body>
        
        
    <div class="book" data-level="6.7" data-basepath="../.." data-revision="Thu Aug 20 2015 14:44:45 GMT+0000 (UTC)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="Type to search" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
        

        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="../../index.html">
                
                        <i class="fa fa-check"></i>
                        
                        An Introduction
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1" >
            
            <span><b>1.</b> Peanut Butter &amp; Jelly</span>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.1" data-path="squads.html">
            
                
                    <a href="../../squads.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.1.</b>
                        
                        Squad Breakdown
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="homework-submission-process.html">
            
            <span><b>1.2.</b> Homework Submission Process</span>
            
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="one-on-ones/readme.html">
            
                
                    <a href="../../one-on-ones/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>1.3.</b>
                        
                        One-on-Ones
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="2" data-path="01-front-end-fundamentals/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        Front End Fundamentals
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1" data-path="01-front-end-fundamentals/command-line/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/command-line/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.1.</b>
                        
                        Command Line Interface
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.2" data-path="01-front-end-fundamentals/git/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/git/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.2.</b>
                        
                        Git
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.3" data-path="01-front-end-fundamentals/intro-to-web-and-html/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/intro-to-web-and-html/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.3.</b>
                        
                        Intro to Web and HTML
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.4" data-path="01-front-end-fundamentals/css/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/css/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.4.</b>
                        
                        CSS
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.5" data-path="01-front-end-fundamentals/javascript-data-types/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/javascript-data-types/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.5.</b>
                        
                        JavaScript Data Types
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.6" data-path="01-front-end-fundamentals/javascript-loops-conditionals/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/javascript-loops-conditionals/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.6.</b>
                        
                        JavaScript Loops &amp; Conditionals
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.7" data-path="01-front-end-fundamentals/javascript-objects-DOM/readme.html">
            
                
                    <a href="../../01-front-end-fundamentals/javascript-objects-DOM/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.7.</b>
                        
                        JavaScript Objects and DOM
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="2.8" data-path="01-front-end-fundamentals/morning-exercises.html">
            
                
                    <a href="../../01-front-end-fundamentals/morning-exercises.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>2.8.</b>
                        
                        Morning Exercises
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3" data-path="02-intermediate-front-end/readme.html">
            
                
                    <a href="../../02-intermediate-front-end/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        Intermediate Front End
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1" data-path="02-intermediate-front-end/scope-context-closures/readme.html">
            
                
                    <a href="../../02-intermediate-front-end/scope-context-closures/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.</b>
                        
                        Scope, Context, and Closures
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="02-intermediate-front-end/scope-context-closures/scope.html">
            
                
                    <a href="../../02-intermediate-front-end/scope-context-closures/scope.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.1.</b>
                        
                        Scope
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="02-intermediate-front-end/scope-context-closures/context.html">
            
                
                    <a href="../../02-intermediate-front-end/scope-context-closures/context.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.2.</b>
                        
                        Context
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="02-intermediate-front-end/scope-context-closures/closures.html">
            
                
                    <a href="../../02-intermediate-front-end/scope-context-closures/closures.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.1.3.</b>
                        
                        Closures
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.2" data-path="02-intermediate-front-end/events-and-callbacks/readme.html">
            
                
                    <a href="../../02-intermediate-front-end/events-and-callbacks/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.2.</b>
                        
                        Events and Callbacks
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.3" data-path="02-intermediate-front-end/git_branching/readme.html">
            
                
                    <a href="../../02-intermediate-front-end/git_branching/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.3.</b>
                        
                        Git Branching
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.4" data-path="02-intermediate-front-end/jquery/jquery-intro-selectors.html">
            
                
                    <a href="../../02-intermediate-front-end/jquery/jquery-intro-selectors.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.4.</b>
                        
                        jQuery
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.5" data-path="02-intermediate-front-end/jquery/jquery-two.html">
            
                
                    <a href="../../02-intermediate-front-end/jquery/jquery-two.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.5.</b>
                        
                        jQuery 2
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.6" data-path="02-intermediate-front-end/workflows/lesson_plan.html">
            
                
                    <a href="../../02-intermediate-front-end/workflows/lesson_plan.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.6.</b>
                        
                        Workflows
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.7" data-path="02-intermediate-front-end/css2/readme.html">
            
                
                    <a href="../../02-intermediate-front-end/css2/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.7.</b>
                        
                        CSS 2 (Layout &amp; Fonts)
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="3.8" data-path="02-intermediate-front-end/homework.html">
            
                
                    <a href="../../02-intermediate-front-end/homework.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>3.8.</b>
                        
                        Homework Assignments
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="4" >
            
                
                    <a target="_blank" href="https:/github.com/ga-dc/pbj-project1/blob/master/readme.md">
                
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        Project 1
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="04-ruby-mvc-sinatra/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        Ruby + MVC with Sinatra
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1" data-path="04-ruby-mvc-sinatra/ruby-basics/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/ruby-basics/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.1.</b>
                        
                        Ruby Basics
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="04-ruby-mvc-sinatra/ruby-enumerables/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/ruby-enumerables/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.2.</b>
                        
                        Ruby Enumerables
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="04-ruby-mvc-sinatra/problem_modeling/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/problem_modeling/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.3.</b>
                        
                        Problem Modeling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.4" data-path="04-ruby-mvc-sinatra/domain_modeling/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/domain_modeling/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.4.</b>
                        
                        Domain Modeling
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.5" data-path="04-ruby-mvc-sinatra/databases/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/databases/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.5.</b>
                        
                        Databases
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.6" data-path="04-ruby-mvc-sinatra/active-record-intro/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/active-record-intro/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.6.</b>
                        
                        Active Record
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.7" data-path="04-ruby-mvc-sinatra/sinatra-rest/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/sinatra-rest/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.7.</b>
                        
                        Sinatra &amp; REST
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="5.8" data-path="04-ruby-mvc-sinatra/sinatra-and-activerecord/readme.html">
            
                
                    <a href="../../04-ruby-mvc-sinatra/sinatra-and-activerecord/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>5.8.</b>
                        
                        Sinatra &amp; Active Record
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="6" data-path="05-mvc-with-rails/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        MVC with Rails
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="6.1" data-path="05-mvc-with-rails/unit_testing_with_rspec/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/unit_testing_with_rspec/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.1.</b>
                        
                        Unit Testing with RSpec
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="05-mvc-with-rails/MVC-intro-to-rails/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/MVC-intro-to-rails/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.2.</b>
                        
                        MVC Intro to Rails
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.3" data-path="05-mvc-with-rails/rails-models-and-migrations/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/rails-models-and-migrations/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.3.</b>
                        
                        Models and Migrations
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.4" data-path="05-mvc-with-rails/rails-views-and-controllers/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/rails-views-and-controllers/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.4.</b>
                        
                        Views and Controllers
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.5" data-path="05-mvc-with-rails/rails-routes-and-resources/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/rails-routes-and-resources/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.5.</b>
                        
                        Routes and Resources
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.6" data-path="05-mvc-with-rails/rails-helpers/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/rails-helpers/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.6.</b>
                        
                        Helpers
                    </a>
            
            
        </li>
    
        <li class="chapter active" data-level="6.7" data-path="05-mvc-with-rails/rails-sessions-and-auth/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/rails-sessions-and-auth/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.7.</b>
                        
                        Sessions and Auth
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="6.8" data-path="05-mvc-with-rails/rails-deployment/readme.html">
            
                
                    <a href="../../05-mvc-with-rails/rails-deployment/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>6.8.</b>
                        
                        Deployment
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="7" >
            
                
                    <a target="_blank" href="https:/github.com/ga-dc/pbj-project2/blob/master/readme.md">
                
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        Project 2
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="07-uxdi-collaboration/readme.html">
            
                
                    <a href="../../07-uxdi-collaboration/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        UXDI Collaboration: The Interactive Web
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="8.1" data-path="07-uxdi-collaboration/apis/readme.html">
            
                
                    <a href="../../07-uxdi-collaboration/apis/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.1.</b>
                        
                        APIs
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.2" data-path="07-uxdi-collaboration/ajax/readme.html">
            
                
                    <a href="../../07-uxdi-collaboration/ajax/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.2.</b>
                        
                        Ajax
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.3" data-path="07-uxdi-collaboration/grids/readme.html">
            
                
                    <a href="../../07-uxdi-collaboration/grids/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.3.</b>
                        
                        Grid Systems
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.4" data-path="07-uxdi-collaboration/animations/readme.html">
            
                
                    <a href="../../07-uxdi-collaboration/animations/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.4.</b>
                        
                        Animations
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="8.5" data-path="07-uxdi-collaboration/responsive-web-design/readme.html">
            
                
                    <a href="../../07-uxdi-collaboration/responsive-web-design/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>8.5.</b>
                        
                        Responsive Web Design
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="9" data-path="08-single-page-web-apps/readme.html">
            
                
                    <a href="../../08-single-page-web-apps/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        &quot;Single Page&quot; Web Applications
                    </a>
            
            
            <ul class="articles">
                
    
        <li class="chapter " data-level="9.1" data-path="08-single-page-web-apps/express_intro/readme.html">
            
                
                    <a href="../../08-single-page-web-apps/express_intro/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.1.</b>
                        
                        Intro to Express
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="9.2" data-path="08-single-page-web-apps/express_routing/readme.html">
            
                
                    <a href="../../08-single-page-web-apps/express_routing/readme.html">
                
                        <i class="fa fa-check"></i>
                        
                            <b>9.2.</b>
                        
                        Express Routing
                    </a>
            
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="10" >
            
                
                    <a target="_blank" href="https:/github.com/ga-dc/pbj-project3/blob/master/readme.md">
                
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        Project 3
                    </a>
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="10-mvw-with-backbone/readme.html">
            
            <span><b>11.</b> MV* with Backbone</span>
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="11-mvw-with-angular/readme.html">
            
            <span><b>12.</b> MV* with Angular</span>
            
            
        </li>
    
        <li class="chapter " data-level="13" >
            
                
                    <a target="_blank" href="https:/github.com/ga-dc/pbj-project4/blob/master/readme.md">
                
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        Portfolio Project
                    </a>
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                Published with GitBook
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="Table of Contents"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="Search"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="Font Settings"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">Serif</button>
        <button type="button" data-font="1" class="button">Sans</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">White</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">Sepia</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">Night</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="Share"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    Share on Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    Share on Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    Share on Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    Share on Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    Share on Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    <a href="#" target="_blank" class="btn pull-right google-plus-sharing-link sharing-link" data-sharing="google-plus" aria-label="Google"><i class="fa fa-google-plus"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right facebook-sharing-link sharing-link" data-sharing="facebook" aria-label="Facebook"><i class="fa fa-facebook"></i></a>
    
    
    <a href="#" target="_blank" class="btn pull-right twitter-sharing-link sharing-link" data-sharing="twitter" aria-label="Twitter"><i class="fa fa-twitter"></i></a>
    
    
    


    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="../../" >Welcome to GA&#39;s WDI-DC</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="sessions-and-auth">Sessions and Auth</h1>
<h2 id="learning-objectives">Learning Objectives</h2>
<ul>
<li>Contrast the use cases for cookies, sessions, and permanent storage.</li>
<li>Define and then access a session variable in a Rails application.</li>
<li>Create a (very) simple hashing algorithm.</li>
<li>Describe the differences between hashing and encoding.</li>
<li>Add sign-in, sign-up, and sign-out functionality to a Rails application.</li>
<li>Securely store and access passwords.</li>
<li>Describe the functionality of <code>has_secure_password</code>.</li>
<li>Differentiate between authentication and authorization.</li>
</ul>
<p><strong>Please follow along with the lesson plan.</strong></p>
<h2 id="adding-users">Adding users</h2>
<p>Currently, Tunr just supports one single user. It would be nice if it could have multiple users. Whenever a user logs in, they&apos;d see only <em>their</em> artists and songs.</p>
<p>To start, let&apos;s <strong>create a User model</strong>. It&apos;s going to be really simple, with just a username and password:</p>
<pre><code>rails generate migration create_users
</code></pre><pre><code class="lang-rb"><span class="hljs-comment"># db/migrate/[timestamp]_users.db</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateUsers</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActiveRecord::Migration</span></span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>change
    create_table <span class="hljs-symbol">:users</span> <span class="hljs-keyword">do</span> |t|
      t.string <span class="hljs-symbol">:username</span>
      t.string <span class="hljs-symbol">:password_digest</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>We&apos;ll talk about why this is <code>password_digest</code> instead of just <code>password</code> later.</p>
<pre><code>rake db:drop
rake db:create
rake db:migrate
</code></pre><p>We&apos;ll need to <strong>create the user model</strong>. We could add in fancy validations to make sure passwords are at least 8 characters or what-have-you, but that&apos;s a &quot;nice-to-have&quot; we can come back to later.</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/models/user.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActiveRecord::Base</span></span></span>
  validates <span class="hljs-symbol">:username</span>, <span class="hljs-symbol">presence:</span> <span class="hljs-keyword">true</span>, <span class="hljs-symbol">uniqueness:</span> <span class="hljs-keyword">true</span>
  validates <span class="hljs-symbol">:password_digest</span>, <span class="hljs-symbol">presence:</span> <span class="hljs-keyword">true</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Next, we&apos;ll create <strong>a sign-up form</strong>. The form will POST to a <code>/sign_up</code> route that we have yet to create.</p>
<pre><code class="lang-erb"><span class="xml"># app/views/users/sign_up.html.erb

<span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Sign up<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
</span>&lt;%=<span class="ruby"> form_tag(<span class="hljs-string">&quot;/sign_up&quot;</span>, <span class="hljs-symbol">method:</span> <span class="hljs-string">&quot;post&quot;</span>) <span class="hljs-keyword">do</span> </span>%&gt;<span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;username&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;password&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;password_confirmation&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;password again&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;Sign up&quot;</span> /&gt;</span>
</span>&lt;%<span class="ruby"> <span class="hljs-keyword">end</span> </span>%&gt;<span class="xml">
</span></code></pre>
<p>Then, we&apos;ll create <strong>a sign-in form</strong>. The form will POST to a <code>/sign_in</code> route, which again we have yet to create.</p>
<pre><code class="lang-erb"><span class="xml"># app/views/users/sign_in.html.erb

<span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Sign in<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
</span>&lt;%=<span class="ruby"> form_tag(<span class="hljs-string">&quot;/sign_in&quot;</span>, <span class="hljs-symbol">method:</span> <span class="hljs-string">&quot;post&quot;</span>) <span class="hljs-keyword">do</span> </span>%&gt;<span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;username&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;password&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;Sign in&quot;</span> /&gt;</span>
</span>&lt;%<span class="ruby"> <span class="hljs-keyword">end</span> </span>%&gt;<span class="xml">
</span></code></pre>
<p>Next, we&apos;ll make links to sign-in, sign-up, and sign-out on the <strong>main application layout</strong>. <em>(We don&apos;t actually have a page for sign-out yet... But we will... sort of!)</em></p>
<pre><code class="lang-erb"><span class="xml"># app/views/layout/application.html.erb

# ...
<span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Tun.r<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">nav</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_in&quot;</span>&gt;</span>Sign in<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_up&quot;</span>&gt;</span>Sign up<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_out&quot;</span>&gt;</span>Sign out<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/songs&quot;</span>&gt;</span>Songs<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/artists&quot;</span>&gt;</span>Artists<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">nav</span>&gt;</span>
# ...
</span></code></pre>
<p>Now we&apos;ll set up the <strong>routes</strong> to direct requests to the proper controller actions:</p>
<h5 id="what-actions-should-a-user-have">What actions should a user have?</h5>
<ul>
<li>We won&apos;t add in an &quot;edit password&quot; functionality yet.<h5 id="what-kind-of-http-request-should-go-to-each-action">What kind of HTTP request should go to each action?</h5>
</li>
</ul>
<pre><code class="lang-rb"><span class="hljs-comment"># config/routes.rb</span>

<span class="hljs-constant">Rails</span>.application.routes.draw <span class="hljs-keyword">do</span>
  root <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;artists#index&apos;</span>
  get <span class="hljs-string">&apos;/songs&apos;</span>, <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;songs#index&apos;</span>
  resources <span class="hljs-symbol">:artists</span> <span class="hljs-keyword">do</span>
    resources <span class="hljs-symbol">:songs</span>
    resources <span class="hljs-symbol">:genres</span>
  <span class="hljs-keyword">end</span>
  get <span class="hljs-string">&apos;/sign_in&apos;</span>, <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;users#sign_in&apos;</span>
  post <span class="hljs-string">&apos;/sign_in&apos;</span>, <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;users#sign_in!&apos;</span>
  get <span class="hljs-string">&apos;/sign_up&apos;</span>, <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;users#sign_up&apos;</span>
  post <span class="hljs-string">&apos;/sign_up&apos;</span>, <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;users#sign_up!&apos;</span>
  get <span class="hljs-string">&apos;/sign_out&apos;</span>, <span class="hljs-symbol">to:</span> <span class="hljs-string">&apos;users#sign_out&apos;</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Now we&apos;ll need a controller to actually receive and respond to these requests.</p>
<p>Let&apos;s make the <strong>users controller</strong>:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ApplicationController</span></span></span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_up
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_up!
    user = <span class="hljs-constant">User</span>.new(
      <span class="hljs-symbol">username:</span> params[<span class="hljs-symbol">:username</span>],
      <span class="hljs-symbol">password_digest:</span> params[<span class="hljs-symbol">:password</span>]
    )
    <span class="hljs-keyword">if</span> params[<span class="hljs-symbol">:password_confirmation</span>] != params[<span class="hljs-symbol">:password</span>]
      message = <span class="hljs-string">&quot;Your passwords don&apos;t match!&quot;</span>
    <span class="hljs-keyword">elsif</span> user.save
      message = <span class="hljs-string">&quot;Your account has been created!&quot;</span>
    <span class="hljs-keyword">else</span>
      message = <span class="hljs-string">&quot;Your account couldn&apos;t be created. Did you enter a unique username and password?&quot;</span>
    <span class="hljs-keyword">end</span>
    puts message
    redirect_to <span class="hljs-symbol">action:</span> <span class="hljs-symbol">:sign_up</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in!
    <span class="hljs-variable">@user</span> = <span class="hljs-constant">User</span>.find_by(<span class="hljs-symbol">username:</span> params[<span class="hljs-symbol">:username</span>])
    <span class="hljs-keyword">if</span> !<span class="hljs-variable">@user</span>
      message = <span class="hljs-string">&quot;This user doesn&apos;t exist!&quot;</span>
    <span class="hljs-keyword">elsif</span> <span class="hljs-variable">@user</span>.password_digest != params[<span class="hljs-symbol">:password</span>]
      message = <span class="hljs-string">&quot;Your password&apos;s wrong!&quot;</span>
    <span class="hljs-keyword">else</span>
      message = <span class="hljs-string">&quot;You&apos;re signed in, <span class="hljs-subst">#{<span class="hljs-variable">@user</span>.username}</span>!&quot;</span>
    <span class="hljs-keyword">end</span>
    puts message
    redirect_to <span class="hljs-symbol">action:</span> <span class="hljs-symbol">:sign_in</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_out
    puts <span class="hljs-string">&quot;You&apos;re signed out!&quot;</span>
    redirect_to root_url
  <span class="hljs-keyword">end</span>

<span class="hljs-keyword">end</span>
</code></pre>
<p>...and now if we <strong>run</strong> our application, we can see that it&apos;s working successfully!</p>
<h2 id="the-flash">The Flash</h2>
<p><code>puts</code>ing out error messages isn&apos;t very helpful, since the user is never going to be able to see them.</p>
<p>Rails gives us a handy method for showing users error messages, called <code>flash</code>. It&apos;s a hash that is generated in one controller action, and is accessible only in the <em>next</em> controller action. That is: a flash message is single-use.</p>
<p>Let&apos;s <strong>add flash messages to the Users controller</strong>:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in!
<span class="hljs-comment"># ...</span>
    flash[<span class="hljs-symbol">:notice</span>] = message
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_up!
<span class="hljs-comment"># ...</span>
    flash[<span class="hljs-symbol">:notice</span>] = message
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_out
<span class="hljs-comment"># ...</span>
    flash[<span class="hljs-symbol">:notice</span>] = message
  <span class="hljs-keyword">end</span>

  <span class="hljs-keyword">end</span>
</code></pre>
<p>...and make the flash messages <strong>show up in the view</strong>:</p>
<pre><code class="lang-erb"><span class="xml"># app/users/application.html.erb

<span class="hljs-tag">&lt;<span class="hljs-title">h1</span>&gt;</span>Tun.r<span class="hljs-tag">&lt;/<span class="hljs-title">h1</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">nav</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_in&quot;</span>&gt;</span>Sign in<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_up&quot;</span>&gt;</span>Sign up<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_out&quot;</span>&gt;</span>Sign out<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/songs&quot;</span>&gt;</span>Songs<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/artists&quot;</span>&gt;</span>Artists<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">nav</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span></span>&lt;%=<span class="ruby"> flash[<span class="hljs-symbol">:notice</span>] </span>%&gt;<span class="xml">
</span></code></pre>
<h2 id="password-security">Password security</h2>
<h5 id="all-the-passwords-are-stored-in-the-database-as-plain-text-why-is-that-a-problem">All the passwords are stored in the database as plain text. Why is that a problem?</h5>
<p>Most people use the same password for many sites. Anyone with access to the database could see people&apos;s passwords and easily try them out on other sites.</p>
<h3 id="two-truths-and-a-lie">Two truths and a lie:</h3>
<ul>
<li>Washington is an expensive city in which to live.</li>
<li>Jesse has nice hair.</li>
<li>It is possible to make something 100% secure.</li>
</ul>
<p>There is no such thing as a completely secure system. With enough time and effort, anything can be hacked.</p>
<p>Your best bet is to make it <strong>annoying</strong> to hack your system.</p>
<h5 id="given-two-systems-what-would-make-a-hacker-choose-to-hack-one-over-the-other">Given two systems, what would make a hacker choose to hack one over the other?</h5>
<ul>
<li>Effort required</li>
<li>Potential payout</li>
<li>Severity of consequences</li>
</ul>
<p>All hackers choose their targets with a simple formula:</p>
<pre><code>desire to hack = (perceived payout relative other targets) - (perceived effort relative other targets)
</code></pre><p>That means you can protect yourself either by making it look like the data your app stores is worthless, <em>or</em> by making your app more annoying to hack than other apps.</p>
<p>If all you&apos;re protecting is a handful of e-mail addresses or comments on a minor blog, a box asking &quot;What is 3 + 7?&quot; is probably sufficient protection. Even though it&apos;s easy to hack, there are so many other sites with even less protection, and those are the ones hackers will target.</p>
<h3 id="hashing">Hashing</h3>
<h5 id="so-how-can-we-make-it-annoying-to-try-to-hack-the-passwords-in-our-database">So how can we make it annoying to try to hack the passwords in our database?</h5>
<ul>
<li>Encrypt<ul>
<li>But what if someone figures out your encryption algorithm?</li>
</ul>
</li>
</ul>
<p>Instead, we use <strong>hashing</strong>, which is like encryption but without the need to decrypt.</p>
<p>For example, take this number:</p>
<pre><code>33993673848282495216560077504280594059128549394489757514768726934773416841839157064011040089835002141848809883232920605619516633004880348600310560794457410501698455318707955859288688370267366292287244426179077614143160867036115289761409284501330209791881804790388195916823965601
</code></pre><p>This is my password, encrypted with an algorithm. I&apos;ll give you some hints: my password is a 7-digit number, and the algorithm is taking that number to the 40th power. So to find my password, all you need to do is find a calculator and enter:</p>
<pre><code>33993673848282495216560077504280594059128549394489757514768726934773416841839157064011040089835002141848809883232920605619516633004880348600310560794457410501698455318707955859288688370267366292287244426179077614143160867036115289761409284501330209791881804790388195916823965601 ^ (1/40)
</code></pre><h5 id="why-am-i-still-confident-that-you-won-t-figure-out-my-password">Why am I still confident that you won&apos;t figure out my password?</h5>
<ul>
<li>Because that&apos;s a really, really difficult calculation for any computer to make!</li>
</ul>
<p>So let&apos;s say instead of my password, the database stores this number, which is only about 260 bytes as a string. When I enter my password, my app takes whatever I entered to the 40th power. If it matches, even though it doesn&apos;t know my actual password, it knows I entered my password correctly. If what I entered is just one number off, the calculation&apos;s result will be completely different, and it won&apos;t match.</p>
<p>This way, the only place my actual password is stored is in my own human memory.</p>
<p>Could someone hack my password? Yes, but it would take a tremendous amount of computer power.</p>
<p>Hashing is used very, very widely in <strong>authentication</strong> -- that is, making sure someone is who they say they are.</p>
<h2 id="hashing-tunr">Hashing Tunr</h2>
<p>We&apos;re going to use a gem called &quot;bcrypt&quot; that uses a really secure hashing algorithm.</p>
<p>Add it to your <strong>Gemfile</strong>...</p>
<pre><code># Gemfile

# ...
gem &apos;bcrypt&apos;
# ...
</code></pre><p>...and <strong>install the Gem</strong>:</p>
<pre><code>bundle install
</code></pre><p>Let&apos;s play around with it in the <strong>rails console</strong>:</p>
<pre><code>rails c
</code></pre><p>BCrypt&apos;s hashing method is <code>BCrypt::Password.create</code>. If we run this multiple times, we get a different result each time:</p>
<pre><code>&gt; BCrypt::Password.create(&quot;hello&quot;)
</code></pre><p>That&apos;s because to keep things <em>really</em> secure, BCrypt adds some random extra letters onto the end of the hash. These extra letters are called a <strong>salt</strong>. This process is <strong>salting a hash</strong>.</p>
<p>To check whether a string matches the hash, we first have to let BCrypt decode its hash:</p>
<pre><code>&gt; BCrypt::Password.create(&quot;hello&quot;)
 =&gt; &quot;$2a$10$yADYNXdzkZC6bLElijmYxuT2bLjG09Oe7i/7asficgWqgHqbj73Ge&quot;
&gt; hash = &quot;$2a$10$yADYNXdzkZC6bLElijmYxuT2bLjG09Oe7i/7asficgWqgHqbj73Ge&quot;
&gt; decoded_hash = BCrypt::Password.new(hash)
&gt; decoded_hash.is_password?(&quot;hello&quot;)
 =&gt; false
&gt; decoded_hash.is_password?(&quot;Hello&quot;)
 =&gt; true
</code></pre><p>Putting this all together in Tunr, we&apos;ll <strong>hash passwords in the Users controller</strong>:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ApplicationController</span></span></span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_up
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_up!
    user = <span class="hljs-constant">User</span>.new(
      <span class="hljs-symbol">username:</span> params[<span class="hljs-symbol">:username</span>],
      <span class="hljs-symbol">password_digest:</span> <span class="hljs-constant">BCrypt::Password</span>.create(params[<span class="hljs-symbol">:password</span>])
    )
    <span class="hljs-keyword">if</span> params[<span class="hljs-symbol">:password_confirmation</span>] != params[<span class="hljs-symbol">:password</span>]
      message = <span class="hljs-string">&quot;Your passwords don&apos;t match!&quot;</span>
    <span class="hljs-keyword">elsif</span> user.save
      message = <span class="hljs-string">&quot;Your account has been created!&quot;</span>
    <span class="hljs-keyword">else</span>
      message = <span class="hljs-string">&quot;Your account couldn&apos;t be created. Did you enter a unique username and password?&quot;</span>
    <span class="hljs-keyword">end</span>
    flash[<span class="hljs-symbol">:notice</span>] = message
    redirect_to <span class="hljs-symbol">action:</span> <span class="hljs-symbol">:sign_up</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in!
    <span class="hljs-variable">@user</span> = <span class="hljs-constant">User</span>.find_by(<span class="hljs-symbol">username:</span> params[<span class="hljs-symbol">:username</span>])
    <span class="hljs-keyword">if</span> !<span class="hljs-variable">@user</span>
      message = <span class="hljs-string">&quot;This user doesn&apos;t exist!&quot;</span>
    <span class="hljs-keyword">elsif</span> !<span class="hljs-constant">BCrypt::Password</span>.new(<span class="hljs-variable">@user</span>.password_digest).is_password?(params[<span class="hljs-symbol">:password</span>])
      message = <span class="hljs-string">&quot;Your password&apos;s wrong!&quot;</span>
    <span class="hljs-keyword">else</span>
      message = <span class="hljs-string">&quot;You&apos;re signed in, <span class="hljs-subst">#{<span class="hljs-variable">@user</span>.username}</span>!&quot;</span>
    <span class="hljs-keyword">end</span>
    flash[<span class="hljs-symbol">:notice</span>] = message
    redirect_to <span class="hljs-symbol">action:</span> <span class="hljs-symbol">:sign_in</span>
  <span class="hljs-keyword">end</span>

  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_out
    flash[<span class="hljs-symbol">:notice</span>] = <span class="hljs-string">&quot;You&apos;re signed out!&quot;</span>
    redirect_to root_url
  <span class="hljs-keyword">end</span>

<span class="hljs-keyword">end</span>
</code></pre>
<h2 id="has-secure-password">has_secure_password</h2>
<p>Rails provides a method called <code>has_secure_password</code> does... about what you would expect from the name. This includes:</p>
<ul>
<li>Making sure a User isn&apos;t created without a password</li>
<li>Makes sure your User model has a <code>password_digest</code> column. A digest is the hashed value of something -- that is, the big long random string. (The way your password would look after you&apos;ve digested it, if you will.)</li>
<li>Making sure the password is less than or equal to 72 characters</li>
<li>If you have a &quot;type your password again to confirm it&quot; field, it makes sure they match</li>
</ul>
<p>To use it, just <strong>add has_secure_password to your User model</strong>:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/models/user.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActiveRecord::Base</span></span></span>
  validates <span class="hljs-symbol">:username</span>, <span class="hljs-symbol">presence:</span> <span class="hljs-keyword">true</span>, <span class="hljs-symbol">uniqueness:</span> <span class="hljs-keyword">true</span>
  has_secure_password
<span class="hljs-keyword">end</span>
</code></pre>
<p>Let&apos;s re-create the database so now it contains only secure passwords:</p>
<pre><code>rake db:drop
rake db:create
rake db:migrate
</code></pre><h2 id="user-persistence">User persistence</h2>
<h5 id="what-s-missing-from-our-user-sign-in-process">What&apos;s missing from our user sign-in process?</h5>
<h5 id="if-i-refresh-the-page-am-i-still-signed-in">If I refresh the page, am I still signed in?</h5>
<p>We need to figure out a way to have Rails remember I&apos;m signed in.</p>
<h5 id="why-not-just-created-an-is-signed-in-column-in-my-user-table">Why not just created an &quot;is_signed_in&quot; column in my User table?</h5>
<ul>
<li>How would Rails now how to sign out? More importantly, if multiple users are accessing the app, how would Rails know which signed_in user is on which computer?</li>
</ul>
<h2 id="cookie-monster">Cookie Monster</h2>
<h3 id="we-do">We do:</h3>
<ol>
<li>In Chrome, go to Preferences</li>
<li>Show advanced settings</li>
<li>Click &quot;Content settings&quot;</li>
<li>Click &quot;All cookies and site data&quot;</li>
<li>Scroll to <code>github.com</code></li>
</ol>
<p>Click around on the different &quot;buttons&quot; or &quot;tabs&quot;. In particular, look at <code>dotcom_user</code>, <code>signed_in</code>, and <code>tz</code>.</p>
<h5 id="turn-and-talk-what-do-you-see-what-do-these-do">Turn and talk: What do you see? What do these do?</h5>
<p>A <em>cookie</em> is a piece of data stored on your computer by your web browser and associated with a particular website.</p>
<h3 id="example-cookies">Example cookies:</h3>
<p>From Github:</p>
<pre><code>Name: dotcom_user
Content: RobertAKARobin
Domain: .github.com
Path: /
Send for: Secure connections only
Accessible to script: No (HttpOnly)
Created: Wednesday, July 22, 2015 at 7:04:22 PM
Expires: Sunday, July 22, 2035 at 7:04:22 PM
</code></pre><p>Normally my online banking account only has 5 cookies, but as soon as I log in it gets an additional 15 or so, including this one:</p>
<pre><code>Name: FORTUNE_COOKIE
Content: abcd-efgh-ijkl-mnop-qrst-uvwx-yz12-3456
Domain: .online.wellsfargo.com
Path: /
Send for: Secure connections only
Accessible to script: No (HttpOnly)
Created: Saturday, July 25, 2015 at 6:07:09 PM
Expires: When the browsing session ends
</code></pre><h5 id="what-might-be-the-purpose-of-these-cookies">What might be the purpose of these cookies?</h5>
<h5 id="why-is-github-s-expiration-date-so-far-in-the-future-while-wells-fargo-s-is-when-the-browsing-session-ends">Why is Github&apos;s expiration date so far in the future, while Wells Fargo&apos;s is when the browsing session ends?</h5>
<h5 id="what-s-the-significance-of-send-for-secure-connections-only">What&apos;s the significance of &apos;Send for: Secure connections only&apos;?</h5>
<p>Notice the &quot;Accessible to script&quot;. Cookies can be accessed via Javascript.</p>
<p>If you go to <code>github.com</code>, open the console, and type <code>document.cookies</code>, you&apos;ll get something like this:</p>
<pre><code>tz=America%2FNew_York; _ga=GA1.2.3456.7890; _gat=1&quot;
</code></pre><p>Hiding from scripts, expiration dates, secure connections only...</p>
<h5 id="turn-and-talk-why-does-security-with-cookies-seem-to-be-such-a-big-deal">Turn and talk: Why does security with cookies seem to be such a big deal?</h5>
<h3 id="writing">Writing</h3>
<p>Modifying cookies is super easy. Let&apos;s have Tunr &quot;remember&quot; the username <strong>when users run the sign_in controller action</strong> by saving it as a cookie:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in!
<span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">else</span>
    message = <span class="hljs-string">&quot;You&apos;re signed in, <span class="hljs-subst">#{<span class="hljs-variable">@user</span>.username}</span>! &quot;</span>
    cookies[<span class="hljs-symbol">:username</span>] = <span class="hljs-variable">@user</span>.username
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>

<span class="hljs-comment"># ...</span>
</code></pre>
<p>If I check the cookies for <code>localhost</code> in Chrome, there&apos;s now a cookie called <code>username</code>!</p>
<p>I can change the expiration time of my cookie like this:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in!
<span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">else</span>
    message = <span class="hljs-string">&quot;You&apos;re signed in, <span class="hljs-subst">#{<span class="hljs-variable">@user</span>.username}</span>! &quot;</span>
    cookies[<span class="hljs-symbol">:username</span>] = {
      <span class="hljs-symbol">value:</span> <span class="hljs-variable">@user</span>.username,
      <span class="hljs-symbol">expires:</span> <span class="hljs-number">100</span>.years.from_now
    }
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
<span class="hljs-comment"># ...</span>
</code></pre>
<p>If I make this <code>10.seconds.from_now</code>, sign in again, and immediately look at the cookies for <code>localhost</code> I can see this cookie. If I close the window, wait a few seconds, and look again, it&apos;s vanished!</p>
<p>By default, the expiration time is &quot;when the current session ends&quot; -- that is, when the browser is closed.</p>
<h3 id="reading">Reading</h3>
<p><code>cookies</code> is a <strong>hash</strong>, just like any other hash. If I put <code>&lt;%= cookies.to_json %&gt;</code> in my <code>.html.erb</code>, it&apos;ll show me all the cookies for this domain (<code>localhost</code>, in this case).</p>
<p>To <strong>read</strong> my cookie, I just use <code>cookies[:username]</code>. I&apos;ll put this in the <code>sign_in_prompt</code> page to <strong>have the username filled in automatically</strong>:</p>
<pre><code class="lang-erb"><span class="xml"># app/views/users/sign_in_prompt.html.erb

<span class="hljs-tag">&lt;<span class="hljs-title">h2</span>&gt;</span>Sign in<span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
</span>&lt;%=<span class="ruby"> form_tag(<span class="hljs-string">&quot;/sign_in&quot;</span>, <span class="hljs-symbol">method:</span> <span class="hljs-string">&quot;post&quot;</span>) <span class="hljs-keyword">do</span> </span>%&gt;<span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;text&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;username&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;</span></span></span>&lt;%=<span class="ruby"> cookies[<span class="hljs-symbol">:username</span>] </span>%&gt;<span class="xml"><span class="hljs-tag"><span class="hljs-value">&quot;</span>/&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">name</span>=<span class="hljs-value">&quot;password&quot;</span> <span class="hljs-attribute">placeholder</span>=<span class="hljs-value">&quot;password&quot;</span> /&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">input</span> <span class="hljs-attribute">type</span>=<span class="hljs-value">&quot;submit&quot;</span> <span class="hljs-attribute">value</span>=<span class="hljs-value">&quot;Sign in&quot;</span> /&gt;</span>
</span>&lt;%<span class="ruby"> <span class="hljs-keyword">end</span> </span>%&gt;<span class="xml">
</span></code></pre>
<p>Now, when I type in a username and &quot;Sign in&quot;, my username is filled in! I can close the browser, and when I go back to the page it&apos;ll still be there.</p>
<p>Hopefully you can start to see the utility of cookies. They were originally invented for e-commerce, to let you store the items in your shopping cart on, say, Amazon. Now they&apos;re used for all kinds of things.</p>
<h3 id="same-old-problem">Same old problem</h3>
<p>Now we can remember the user&apos;s username. But we&apos;re not actually remembering the user is signed in.</p>
<p>We could just create a cookie called <code>is_signed_in</code> and set that to true.</p>
<h5 id="what-could-go-wrong-with-using-an-is-signed-in-cookie">What could go wrong with using an <code>is_signed_in</code> cookie?</h5>
<ul>
<li>Cookies are stored on the user&apos;s computer. This means we&apos;re basically relying on a user to tell us whether or not they&apos;re signed in. That&apos;s not very secure. There are Chrome extensions that let you add and edit the cookies on your computer. <strong>We</strong> want to tell the <strong>user</strong> whether or not they&apos;re signed in, not have them tell us.</li>
</ul>
<h2 id="sessions">Sessions</h2>
<p>Remember <code>flash</code> messages? Those are a lot like cookies, except instead of being stored on the user&apos;s browser, they&apos;re stored on <strong>your server</strong>.</p>
<p>This is an example of a <strong>session variable</strong>. It&apos;s like a cookie in reverse. A cookie is stored on the user&apos;s browser and associated with a particular domain. A session variable is stored on the server and associated with a particular user&apos;s browser.</p>
<p>Because session variables are stored on your server, the user can&apos;t manipulate them.</p>
<h3 id="how-sessions-work">How sessions work</h3>
<p>When your browser starts interacting with a server -- that is, when you go to a website -- the server gives you a unique ID and stores it as a cookie on your computer.</p>
<p>Then, the server can save data and store it, associated with that ID.</p>
<p>Like this:</p>
<pre><code># USER&apos;S BROWSER

cookies = {
  &quot;google.com&quot;: {...},
  &quot;tunr.com&quot;: {
    &quot;username&quot;: &quot;robin&quot;,
    &quot;session_id&quot;: &quot;8675309&quot;
  }
}
</code></pre><pre><code># YOUR SERVER

session_vars = {
  &quot;1234567&quot;: {...},
  &quot;8675309&quot;: {
    &quot;is_signed_in&quot;: true
  }
}
</code></pre><p>Whenever you use a session variable in your code, your server just checks the user&apos;s browser for that cookie, gets the ID, and then looks up all the session variables for that ID.</p>
<p>Rails automatically generates that ID for you. We can see it in our cookies:</p>
<pre><code>Name: _tunr_session
Content:  abcdefghijklmnopqrstuvwxyz
Domain: localhost
Path: /
Send for: Any kind of connection
Accessible to script: No (HttpOnly)
Created:  Tuesday, July 28, 2015 at 10:54:08 AM
Expires:  When the browsing session ends
</code></pre><h5 id="looking-at-this-cookie-why-would-you-say-session-variables-are-called-ession-variables">Looking at this cookie, why would you say session variables are called &quot;ession variables&quot;?</h5>
<ul>
<li>The session ID is destroyed when your browsing session ends, making those session variables inaccessible.</li>
</ul>
<h3 id="applying-to-tunr">Applying to Tunr</h3>
<p>Let&apos;s add an <code>is_signed_in</code> session variable to Tunr. We&apos;ll create it in the Users controller. </p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_in!
<span class="hljs-comment"># ...</span>
  <span class="hljs-keyword">else</span>
    message = <span class="hljs-string">&quot;You&apos;re signed in, <span class="hljs-subst">#{<span class="hljs-variable">@user</span>.username}</span>! &quot;</span>
    cookies[<span class="hljs-symbol">:username</span>] = {
      <span class="hljs-symbol">value:</span> <span class="hljs-variable">@user</span>.username,
      <span class="hljs-symbol">expires:</span> <span class="hljs-number">100</span>.years.from_now
    }
    session[<span class="hljs-symbol">:user</span>] = <span class="hljs-variable">@user</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-comment"># ...</span>
<span class="hljs-keyword">end</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>sign_out!
  reset_session
  redirect_to root_url
<span class="hljs-keyword">end</span>
</code></pre>
<p>Now let&apos;s <strong>modify the application layout accordingly</strong>. If the user isn&apos;t signed in, we&apos;ll show &quot;sign in&quot; and &quot;sign up&quot; links. If they <strong>are</strong> signed in, we&apos;ll show a &quot;sign out&quot; link.</p>
<pre><code class="lang-erb"><span class="xml"># app/views/layouts/application.html.erb

# ...
<span class="hljs-tag">&lt;<span class="hljs-title">nav</span>&gt;</span>
  </span>&lt;%<span class="ruby"> <span class="hljs-keyword">if</span> session[<span class="hljs-symbol">:user</span>] </span>%&gt;<span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_out&quot;</span>&gt;</span></span>&lt;%=<span class="ruby"> session[<span class="hljs-symbol">:user</span>][<span class="hljs-string">&quot;username&quot;</span>] </span>%&gt;<span class="xml">: sign out<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-title">h2</span>&gt;</span>
  </span>&lt;%<span class="ruby"> <span class="hljs-keyword">else</span> </span>%&gt;<span class="xml">
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_up&quot;</span>&gt;</span>Sign up<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
    <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/sign_in&quot;</span>&gt;</span>Sign in<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  </span>&lt;%<span class="ruby"> <span class="hljs-keyword">end</span> </span>%&gt;<span class="xml">
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/songs&quot;</span>&gt;</span>Songs<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
  <span class="hljs-tag">&lt;<span class="hljs-title">a</span> <span class="hljs-attribute">href</span>=<span class="hljs-value">&quot;/artists&quot;</span>&gt;</span>Artists<span class="hljs-tag">&lt;/<span class="hljs-title">a</span>&gt;</span>
<span class="hljs-tag">&lt;/<span class="hljs-title">nav</span>&gt;</span>
# ...
</span></code></pre>
<h3 id="before-actions">Before actions</h3>
<p>We&apos;ll tighten up this app even more by making it so you can&apos;t see <strong>anything</strong> unless you&apos;ve logged in.</p>
<p>We&apos;re going to use a method called <code>before_action</code>. This lets us do something before <em>every single action</em> happens.</p>
<p>In this case, we&apos;re going to use it to authenticate the user before every action.</p>
<h5 id="what-s-the-difference-between-authenticate-and-authorize">What&apos;s the difference between &quot;authenticate&quot; and &quot;authorize&quot;?</h5>
<ul>
<li>Authenticating is checking whether someone is who they say they are</li>
<li>Authorizing is giving someone special privileges<ul>
<li>So when you&apos;ve <em>authenticated</em> a user, they are <em>authorized</em> to use your app</li>
</ul>
</li>
</ul>
<p>Let&apos;s <strong>update the application controller to authenticate before every action</strong>:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/application_controller.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ApplicationController</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActionController::Base</span></span></span>
  <span class="hljs-comment"># Prevent CSRF attacks by raising an exception.</span>
  <span class="hljs-comment"># For APIs, you may want to use :null_session instead.</span>
  protect_from_forgery <span class="hljs-symbol">with:</span> <span class="hljs-symbol">:exception</span>
  before_action <span class="hljs-symbol">:authenticate</span>

  private
  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>authenticate
    <span class="hljs-keyword">if</span> !session[<span class="hljs-symbol">:user</span>]
      redirect_to <span class="hljs-string">&quot;/sign_in&quot;</span>
    <span class="hljs-keyword">end</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p><em>(<strong>Note</strong> that <code>protect_from_forgery</code> thing: that works via sessions. It inserts a hidden random string on every form in your app. When that form is submitted, Rails compares that string against a session variable it set for you.)</em></p>
<p>If we run the app now... we&apos;ll get a &quot;too many redirects&quot; error. That&apos;s because we&apos;re telling the app to redirect to the sign_in page before every action... including just trying to go to the sign_in page. So when someone is directed to the sign_in page, they&apos;re redirected to the sign_in page, and redirected, and redirected...</p>
<p>We want this authentication to happen on every action <strong>except</strong> the user actions. So we can use another special method called <code>skip_before_action</code>.</p>
<p>Let&apos;s update the <strong>User controller</strong> to prevent authentication, and therefore an infinite loop:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/users_controller.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ApplicationController</span></span></span>
  skip_before_action <span class="hljs-symbol">:authenticate</span>
<span class="hljs-comment"># ...</span>
<span class="hljs-keyword">end</span>
</code></pre>
<h2 id="putting-it-all-together">Putting it all together</h2>
<p>The goal for this app is for it to serve as your personal playlist. Each user will see only the songs and artists they created.</p>
<p>Now that we&apos;re letting the app have multiple users, we need to associate each song and artist with a particular user.</p>
<p><strong>Important note:</strong> The way the app&apos;s set up, if 30 users all add &quot;Bohemian Rhapsody&quot; to their playlist, there will be 30 copies of &quot;Bohemian Rhapsody&quot; and in the &quot;Songs&quot; table, and at least 30 copies of &quot;Queen&quot; in the &quot;Artists&quot; table. This isn&apos;t very efficient, but it&apos;s useful for demonstrating the concepts we&apos;re covering here.</p>
<h5 id="how-do-we-associate-songs-and-artists-with-a-user">How do we associate songs and artists with a user?</h5>
<ul>
<li>Give the <code>songs</code> and <code>artists</code> tables a <code>user_id</code> column?<ul>
<li>We can actually do it with less work. Each song already belongs to an artist, so we&apos;ll just make each artist belong to a user and leave the songs alone -- that is, we&apos;ll <strong>add a <code>user_id</code> column to the <code>artists</code> table</strong>. <em>(This means you can&apos;t have a song without an artist, but I&apos;m OK with that.)</em></li>
</ul>
</li>
</ul>
<pre><code>rails generate migration add_users_to_artists
</code></pre><pre><code class="lang-rb"><span class="hljs-comment"># db/migrate/[timestamp]_add_users_to_artists.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AddUserToArtists</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActiveRecord::Migration</span></span></span>
  <span class="hljs-function"><span class="hljs-keyword">def</span> </span>change
    add_column <span class="hljs-symbol">:artists</span>, <span class="hljs-symbol">:user_id</span>, <span class="hljs-symbol">:integer</span>
  <span class="hljs-keyword">end</span>
<span class="hljs-keyword">end</span>
</code></pre>
<pre><code>rake db:drop
rake db:create
rake db:migrate
</code></pre><p>Now let&apos;s make sure we can do <code>@user.artists</code> and <code>@artist.user</code> and so forth by <strong>updating the Artist model and creating a User model</strong>:</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/models/artist.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Artist</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActiveRecord::Base</span></span></span>
  has_many <span class="hljs-symbol">:songs</span>, <span class="hljs-symbol">dependent:</span> <span class="hljs-symbol">:destroy</span>
  belongs_to <span class="hljs-symbol">:user</span>
<span class="hljs-keyword">end</span>
</code></pre>
<pre><code class="lang-rb"><span class="hljs-comment"># app/models/user.rb</span>

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">User</span> <span class="hljs-inheritance">&lt; <span class="hljs-parent">ActiveRecord::Base</span></span></span>
  has_secure_password
  has_many <span class="hljs-symbol">:artists</span>
<span class="hljs-keyword">end</span>
</code></pre>
<p>Let&apos;s <strong>change the <code>artists</code> controller so that whenever you add an artist, it saves the username</strong>.</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/artists_controller.rb</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>create
  <span class="hljs-variable">@user</span> = <span class="hljs-constant">User</span>.find(session[<span class="hljs-symbol">:user</span>][<span class="hljs-string">&quot;id&quot;</span>])
  <span class="hljs-variable">@artist</span> = <span class="hljs-variable">@user</span>.artists.create!(artist_params)
  redirect_to (artist_path(<span class="hljs-variable">@artist</span>))
<span class="hljs-keyword">end</span>
</code></pre>
<p>With this done, we can <strong>modify the controller to show the songs and artists for this user only</strong>.</p>
<pre><code class="lang-rb"><span class="hljs-comment"># app/controllers/artists_controller.rb</span>

<span class="hljs-function"><span class="hljs-keyword">def</span> </span>index
  <span class="hljs-variable">@artists</span> = <span class="hljs-constant">User</span>.find(session[<span class="hljs-symbol">:user</span>][<span class="hljs-string">&quot;id&quot;</span>]).artists
<span class="hljs-keyword">end</span>
</code></pre>
<h2 id="review">Review</h2>
<h5 id="what-are-the-steps-for-adding-user-authentication">What are the steps for adding user authentication?</h5>
<ol>
<li>User migration</li>
<li>User model</li>
<li>Install BCrypt gem</li>
<li>User controller<ul>
<li>Sign up</li>
<li>Sign in</li>
<li>Sign out</li>
</ul>
</li>
<li>Routes</li>
</ol>
<h5 id="what-are-the-three-bcrypt-methods-we-used">What are the three BCrypt methods we used?</h5>
<ul>
<li><code>hash = BCrypt::Password.create(&quot;hello&quot;)</code></li>
<li><code>decoded_hash = BCrypt::Password.new(hash)</code></li>
<li><code>decoded_hash.is_password?(&quot;hello&quot;)</code></li>
</ul>
<h5 id="where-are-a-cookies-and-b-session-variables-stored">Where are (a) cookies and (b) session variables stored?</h5>
<ul>
<li>(a) the server, (b) the browser</li>
<li>(a) the browser, (b) the database</li>
<li>(a) the database, (b) the server</li>
<li>(a) the browser, (b) the server</li>
</ul>
<h5 id="what-s-the-difference-between-encryption-and-hashing">What&apos;s the difference between encryption and hashing?</h5>
<h5 id="what-s-the-difference-between-authenticating-and-authorizing">What&apos;s the difference between authenticating and authorizing?</h5>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="../../05-mvc-with-rails/rails-helpers/readme.html" class="navigation navigation-prev " aria-label="Previous page: Helpers"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="../../05-mvc-with-rails/rails-deployment/readme.html" class="navigation navigation-next " aria-label="Next page: Deployment"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="../../gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":null,"family":"sans","size":2}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
